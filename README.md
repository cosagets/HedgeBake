# HedgeBake
A Blender addon that bakes GI maps for Hedgehog Engine 1 games using Cycles.
## How to install
Download the .zip file from the releases page

In Blender, go to **Edit** -> **Preferences** -> **Add-ons**

Click on the down arrow and select '**Install from Disk**'

Navigate to the .zip file and click '**Install from Disk**'

![1](https://github.com/user-attachments/assets/43e36016-074c-4e77-b0d1-76169f60d01a)
![2](https://github.com/user-attachments/assets/95bcd85d-e48e-4c25-971f-0d8011b152c6)

## How to use

![3](https://github.com/user-attachments/assets/d399e064-86ab-4532-ac57-7c3cab11a249)

After installing, press the N key to open Blender's N panel, then click the HedgeBake tab to open its panel.

Click on the folder icon next to **Output Directory** to browse to and select your output directory. This will be where your GI maps are stored. You can click '**Open Directory**' to open the directory you selected.

If you have a render list file, click on the folder icon next to '**Render List**' to browse to and select your render list file. This file is can be generated by [HedgeGI](https://github.com/blueskythlikesclouds/HedgeGI) or the GIAtlas Converter from [libgens-sonicglvl](https://github.com/DarioSamo/libgens-sonicglvl) and be used to decide what resolution each object will be. You can click '**Open File**' you open your render list.

Click the number below '**Resolution**' to select your desired resolution from a dropdown list. This will be the resolution of all of your baked maps unless you check 'Use Render List.'

Check the '**Use Render List**' option to use a render list. This option overrides the resolution selected previously and uses the resolutions provided by the render list.

Check '**Denoise**' to use denoising on your maps

Check '**Skip Existing Files**' to skip baking anything for objects that already have an associated lightmap and shadowmap in the output directory

Click '**Bake**' to begin the baking process. You can monitor its progress by opening Blender's System Console window before baking.

If there's an issue preventing you from baking, you'll receive a message created by the addon letting you know what the issue is.

To actually bring the GI maps into the game, you'll need to first use the GIAtlas Converter from [libgens-sonicglvl](https://github.com/DarioSamo/libgens-sonicglvl) on your stage. Then, you'll need to open [HedgeGI](https://github.com/blueskythlikesclouds/HedgeGI), open your stage, set the Output Directory path to the location where your files are stored, set it to Global Illumination mode, and select '**Pack**'. DO NOT SELECT '**Bake**' or '**Bake and Pack**' because you may overwrite your files if '**Skip Existing Files**' isn't checked.

## Important notes

This addon makes various changes to the blender scene when its running and reverts those changes when done. If it runs into an error, those changes won't be revert back.

![4](https://github.com/user-attachments/assets/200c4661-a55c-47b9-a017-82767e48e1d2)

If this happens, make sure to undo Blender to the point before running the script. You can ensure you do by going to **Edit** -> **Undo History** and clicking the step before '**Bake**.'

The messages created by the addon are meant to prevent this from happening. So if you run into an error, you can report it as an issue.

![5](https://github.com/user-attachments/assets/80f68932-af61-4ee4-ba35-63b5fc526ebe)

Also remember that any object that has the camera icon next to it will be visible in bakes. So, for example, if you keep your stage collision in the same Blender scene as your terrain, you'll want to disable it as a renderable object or bakes will look wrong.

Finally, I've include two python scripts called Bakemaps.py and Error_Checking.py. These are the standalone, script only, versions of the code for those who are interested.
